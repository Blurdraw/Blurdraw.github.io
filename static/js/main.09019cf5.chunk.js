(this.webpackJsonpdemo=this.webpackJsonpdemo||[]).push([[0],{153:function(e,t,a){},184:function(e,t,a){e.exports=a(323)},189:function(e,t,a){},190:function(e,t,a){},265:function(e,t,a){},322:function(e,t,a){},323:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(10),l=a.n(i),o=(a(189),a(190),a(5)),s=a(6),c=a(9),u=a(7),d=a(8),p=a(42),h=a(56),m=a(336),f=a(24),g=a(72);var b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,a={};switch(t.type){case"changetheme":a=t.payload;break;default:a=e}return a};var v,y=Object(g.b)({theme:b,themeName:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light",t=arguments.length>1?arguments[1]:void 0,a={};switch(t.type){case"changethemename":a=t.payload;break;default:a=e}return a},bgBlurSize:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0,a=0;switch(t.type){case"changeblursize":a=t.payload;break;default:a=e}return a},links:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=arguments.length>1?arguments[1]:void 0;switch(a.type){case"changeLinks":e=a.payload;break;case"addLinks":console.log(t,a),t.push(a.payload),e=t;break;default:e=t}return e},user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,a={};switch(t.type){case"userLogin":t.payload.login=!0,a=t.payload;break;case"userLoginOut":a.login=!1;default:a=e}return a},bgPic:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case"bgPicChange":e=a.payload;break;case"bgIndexChange":t.index=a.payload,e=t;break;default:e=t}return e},dockOpacity:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.7,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case"changeopacitysize":e=a.payload,localStorage.setItem("dorkopacity",e);break;default:e=t}return e}}),E={themes:[],__theme:null,themeIndex:0,init:function(){this.themes=[{name:"light",base:{backgroundColor:"#fff",color:"#000"}},{name:"dark",base:{backgroundColor:"#242324",color:"#fff"}}],this.__theme=this.themes[this.themeIndex]},get theme(){return this.__theme},changeTheme:function(){this.themeIndex=(this.themeIndex+1)%this.themes.length,this.__theme=this.themes[this.themeIndex]}},k={ajax:function(e){var t=new XMLHttpRequest;t.onreadystatechange=function(){if(4==t.readyState&&200==t.status){if("json"==e.dataType)try{var a=JSON.parse(t.responseText);e.success(a)}catch(n){console.log(n)}}else t.status>=400&&e.error("error:"+t.status)},t.open(e.type,e.url,e.async),"json"==e.dataType&&t.setRequestHeader("Accept","application/json, text/javascript, */*; q=0.01"),t.setRequestHeader("Content-type","application/x-www-form-urlencoded"),"POST"==e.type?t.send(e.data):t.send()}},O={_links:[],init:function(){this.get_list(),console.log(this.links)},get_list:function(){var e,t=this;(e=window.localStorage.getItem("linkList"))?this._links=JSON.parse(e):k.ajax({url:"http://localhost/ftp/applist.json",async:!1,dataType:"json",type:"GET",success:function(e){t._links=e,window.localStorage.setItem("linkList",JSON.stringify(e))},error:function(e){console.log(e)}})},get links(){return this._links}},j={init:function(){var e,t,a=0;return(e=localStorage.getItem("bgPics"))&&(a=localStorage.getItem("bgPicsIndex"))?t=JSON.parse(e):(t=[{url:"http://pic1.win4000.com/wallpaper/b/55597435bb036.jpg",name:"\u6d77"},{url:"https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1585416671231&di=2b31d51afd46d03e492b10d8b089ccdd&imgtype=0&src=http%3A%2F%2Fdesk-fd.zol-img.com.cn%2Ft_s960x600c5%2Fg4%2FM02%2F01%2F0C%2FCg-4zFU5saeIEEOaAAcatIe29xYAAXVdAEdnLsABxrM840.jpg",name:"\u5929"}],localStorage.setItem("bgPics",JSON.stringify(t)),localStorage.setItem("bgPicsIndex",0)),{picUrls:t,index:a}}};E.init(),O.init(),(v=localStorage.getItem("dorkopacity"))||(v=.7,localStorage.setItem("dorkopacity",v));var w=Object(g.c)(y);w.dispatch({type:"changetheme",payload:E.theme}),w.dispatch({type:"changeLinks",payload:O.links}),w.dispatch({type:"changeblursize",payload:0}),w.dispatch({type:"bgPicChange",payload:j.init()}),w.dispatch({type:"changeopacitysize",payload:v});var S=w;var x=function(){var e=new Map;function t(t){e.has(t)?console.warn("\u4e00\u4e2a\u76f8\u540c\u7684topic"+t+"\u5df2\u7ecf\u88ab\u521b\u5efa\u4e86"):e.set(t,new Array)}return{newtopic:t,pub:function(t){if(e.has(t)){for(var a=arguments.length,n=new Array(a>1?a-1:0),r=1;r<a;r++)n[r-1]=arguments[r];var i=!0,l=!1,o=void 0;try{for(var s,c=e.get(t)[Symbol.iterator]();!(i=(s=c.next()).done);i=!0)s.value.apply(void 0,n)}catch(u){l=!0,o=u}finally{try{i||null==c.return||c.return()}finally{if(l)throw o}}}else console.warn("\u6ca1\u6709:"+t+"\u8fd9\u4e2atopic")},sub:function(a,n){e.has(a)||(t(a),console.warn("\u8ba2\u9605\u4e86:"+a+"\u8fd9\u4e2atopic,\u4f46\u662f\u5b83\u5e76\u4e0d\u5b58\u5728, \u73b0\u5728\u5b83\u5df2\u7ecf\u521b\u5efa\u4e86. \u8bf7\u6ce8\u610f\u4ee5\u9632\u51fa\u73b0\u9519\u8bef.")),e.get(a).push(n)}}}(),C=a(324),_=a(333),I=a(338),z=a(339),A=a(340),N=a(341),L=a(342),P=a(343),B=(C.a.Header,C.a.Content,C.a.Footer,C.a.Sider,function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement(_.a,{style:{backgroundColor:"rgba(255,255,255,0.6)"},theme:"light",defaultSelectedKeys:["1"]},r.a.createElement(_.a.Item,{key:"1"},r.a.createElement(z.a,null),r.a.createElement(p.b,{className:"nav-text",to:"/home"},"\u4e3b\u9875")),r.a.createElement(_.a.Item,{key:"2"},r.a.createElement(A.a,null),r.a.createElement(I.a,{count:0},r.a.createElement(p.b,{className:"nav-text",to:"/message"},"\u6d88\u606f"))),r.a.createElement(_.a.Item,{key:"3"},r.a.createElement(N.a,null),r.a.createElement("span",{className:"nav-text"},"\u6269\u5c55")),r.a.createElement(_.a.Item,{key:"4"},r.a.createElement(L.a,null),r.a.createElement(p.b,{className:"nav-text",to:"/setting"},"\u8bbe\u7f6e")),r.a.createElement(_.a.Item,{key:"5"},r.a.createElement(P.a,null),r.a.createElement(p.b,{className:"nav-text",to:"/about"},"\u5173\u4e8e")))}}]),t}(r.a.Component)),D=a(80),M=a(39),U=(a(153),{inputFocus:{width:"99%"}}),J=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={isFocus:!1},a.handlefoucus=function(e){""!=e.target.value?(a.setState({isFocus:!0}),x.pub("input-focus")):a.setState({isFocus:!1})},a.handleblur=function(e){""==e.target.value&&(x.pub("input-blur"),a.setState({isFocus:!1}))},a.handelInput=function(e){""!=e.target.value?(a.setState({isFocus:!0}),x.pub("input-inputing",e.target.value)):a.setState({isFocus:!1})},a.onKeyup=function(e){13===e.keyCode&&x.pub("input-go")},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){x.newtopic("input-focus"),x.newtopic("input-blur"),x.newtopic("input-inputing"),x.newtopic("input-go")}},{key:"render",value:function(){return r.a.createElement("input",{type:"text",style:this.state.isFocus?U.inputFocus:{width:"70%"},size:"20",className:"search_input",placeholder:"search",onChange:this.handelInput,onFocus:this.handlefoucus,onBlur:this.handleblur,onKeyUp:this.onKeyup})}}]),t}(r.a.Component),F={backgroundColor:"rgba(255,255,255,0.2)",padding:"5px",borderRadius:"5px",color:"#000",margin:"5px"},T=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("a",{href:this.props.url,target:"_blank"},r.a.createElement("div",{class:"adv_item",style:F},this.props.type,":",r.a.createElement("br",null),this.props.keyword))}}]),t}(r.a.Component),W={inited:!1,init:function(){this.inited||(/(iPhone|iPad|iPod|iOS|Android)/i.test(navigator.userAgent)?this.__device_type="phone":this.__device_type="pc",x.newtopic("screen-scale-change"),window.onresize=function(){W.set_scale()},this.set_scale(),this.inited=!0)},__screen_scale:"",__device_type:"pc",get device_type(){return this.__device_type},get screen_scale(){return this.__screen_scale},set_scale:function(){var e=this.__screen_scale;document.body.clientWidth<450?this.__screen_scale="small":document.body.clientWidth<900?this.__screen_scale="middle":this.__screen_scale="large",e!=this.__screen_scale&&x.pub("screen-scale-change",this.__screen_scale)}},R=W,q={baidusearch:function(e){var t="https://www.baidu.com/baidu?wd=";return"pc"==R.device_type?t+=e:t="https://m.baidu.com/s?word="+e,{type:"\u767e\u5ea6(\u9ed8\u8ba4)",url:t}},baidutrans:function(e){var t="https://fanyi.baidu.com/translate?aldtype=16047&query=&keyfrom=baidu&smartresult=dict&lang=auto2zh#en/zh/"+e,a="https://www.baidu.com/sf_fanyi/?aldtype=38319&tpltype=sigma#zh/en/"+e;return{type:"\u767e\u5ea6\u7ffb\u8bd1",url:t="pc"==R.device_type?t:a}},get_adv:function(e){for(var t=[],a=0,n=[this.baidusearch,this.baidutrans];a<n.length;a++){var r=n[a];t.push(r(e))}return t}},H=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={keyword:"",display:!1,advs:null},a.handelBlur=function(){a.setState({display:!1})},a.handelInput=function(e){e?(a.findAdv(e),a.setState({keyword:e,display:!0})):a.setState({display:!1})},a.findAdv=function(e){var t=q.get_adv(e);a.setState({advs:t})},a.goDefault=function(){window.open(a.state.advs[0].url,"_blank")},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){x.sub("input-inputing",this.handelInput),x.sub("input-blur",this.handelBlur),x.sub("input-go",this.goDefault)}},{key:"render",value:function(){var e=this,t=[];return this.state.advs&&(t=this.state.advs.map((function(t,a){return r.a.createElement(T,{url:t.url,type:t.type,keyword:e.state.keyword,key:a})}))),r.a.createElement("div",{style:{display:this.state.display?"block":"none"},className:"adv_panel"},t)}}]),t}(r.a.Component),K=a(334),G=a(329),Y=a(337),X=a(55),V=a(325);function $(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];var n=t.reduce((function(e,t){for(var a in t)e[a]=t[a];return e}),{});return n}var Q={itemContainer:{float:"left"}},Z=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){r.a.createElement(X.a,null,"del"+this.props.index);return r.a.createElement("a",{href:this.props.url,style:{color:this.props.theme.color}},r.a.createElement("div",{style:Q.itemContainer},r.a.createElement("div",{align:"center"},r.a.createElement(V.a,{src:this.props.url+"/favicon.ico",size:50,alt:"?"}))))}}]),t}(r.a.Component);var ee=Object(f.b)((function(e){return{theme:e.theme.base}}))(Z),te=a(344),ae={itemContainer:{float:"left"}},ne=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).handleClick=function(){a.props.open()},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{style:ae.itemContainer,onClick:this.handleClick},r.a.createElement("div",{align:"center"},r.a.createElement(V.a,{size:50,icon:r.a.createElement(te.a,null)})))}}]),t}(r.a.Component),re=a(164),ie=a(134),le=a(345),oe=a(346),se=a(347),ce={width:"100%",fontSize:"1.2rem",backgroundColor:"#eee",borderWidth:1,borderColor:"#ddd",borderStyle:"solid",display:"flex",flexDirection:"row",justifyContent:"space-between"},ue={display:"none"},de={display:"block",borderWidth:1,borderColor:"#ddd",borderStyle:"solid",margin:"0px 0px 5px 0px"},pe=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={showEdit:!1,name:a.props.item.name,url:a.props.item.url},a.showEdit=function(){a.setState({showEdit:!a.state.showEdit})},a.del=function(){var e=Object(re.a)(Array,Object(ie.a)(a.props.list));e.splice(parseInt(a.props.index),1),a.props.updata(e)},a.moveUp=function(){var e=a.props.index,t=a.props.list;if(e>0){var n=t[e-1];t[e-1]=t[e],t[e]=n,a.props.updata(t)}},a.change=function(){var e=a.props.index,t=a.props.list;(a.iname.state.value||a.iurl.state.value)&&(a.iname.state.value&&(t[e].name=a.iname.state.value),a.iurl.state.value&&(t[e].url=a.iurl.state.value),a.props.updata(t))},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=this.state.name,a=this.state.url;return r.a.createElement("div",null,r.a.createElement("div",{style:ce},this.props.item.name,r.a.createElement("div",null,r.a.createElement(le.a,{onClick:this.moveUp}),r.a.createElement(oe.a,{onClick:this.showEdit}),r.a.createElement(se.a,{onClick:this.del}))),r.a.createElement("div",{style:this.state.showEdit?de:ue},r.a.createElement(Y.a,{ref:function(t){return e.iname=t},placeholder:t}),r.a.createElement(Y.a,{ref:function(t){return e.iurl=t},placeholder:a}),r.a.createElement(X.a,{onClick:this.change},"\u786e\u5b9a"),r.a.createElement(X.a,{onClick:this.showEdit},"\u6536\u8d77")))}}]),t}(r.a.Component),he=Object(f.b)((function(e){return{list:Object(ie.a)(e.links)}}),(function(e){return{updata:function(t){localStorage.setItem("linkList",JSON.stringify(t)),e({type:"changeLinks",payload:t})}}}))(pe),me=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props.list.map((function(e,t){return r.a.createElement(he,{item:e,key:e.name+t,index:t})}));return r.a.createElement("div",null,e)}}]),t}(r.a.Component),fe=(a(265),function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={vis:!1,opacity:a.props.dockOpacity},a.baseTheme={display:"flex",padding:"5px",margin:"0px 10px",borderRadius:"15px",flexDirection:"row",flexWrap:"wrap",backgroundColor:"rgba(255,255,255,"+a.state.opacity+")",justifyContent:"space-between"},a.handleOk=function(){a.add(),K.a.info("\u6dfb\u52a0\u5b8c\u6210"),a.setState({vis:!1})},a.handleCancel=function(){a.setState({vis:!1})},a.open=function(){a.setState({vis:!0})},a.add=function(){var e=a.refs.title.state.value,t=a.refs.url.state.value;a.props.links.push({name:e,url:t,frequency:0}),localStorage.setItem("linkList",JSON.stringify(a.props.links)),a.handleCancel()},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"componentWillUnmount",value:function(){}},{key:"render",value:function(){var e=this.props.links.map((function(e,t){return r.a.createElement(ee,{url:e.url,linkname:e.name,key:t,index:t})}));return r.a.createElement("div",{style:this.baseTheme},e,r.a.createElement(ne,{open:this.open}),r.a.createElement(G.a,{title:"\u7f16\u8f91",visible:this.state.vis,onOk:this.handleOk,onCancel:this.handleCancel},r.a.createElement(me,{list:this.props.links}),r.a.createElement("br",null),"\u6dfb\u52a0",r.a.createElement(Y.a,{ref:"title",placeholder:"\u6807\u9898"}),r.a.createElement(Y.a,{ref:"url",placeholder:"url"})))}}]),t}(r.a.Component));var ge=Object(f.b)((function(e){return{theme:e.theme,links:e.links,dockOpacity:e.dockOpacity}}))(fe),be={fontSize:"3rem",textAlign:"center",color:"#fff"},ve=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={hour:0,min:0},a.getTime=function(){var e,t,n;setInterval((function(){e=new Date,n=e.getMinutes(),t=e.getHours(),a.state.min==n&&a.state.hour==t||(n<10&&(n="0"+n),a.setState({hour:t,min:n}))}),1e3)},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.getTime()}},{key:"render",value:function(){return r.a.createElement("div",{style:be},this.state.hour,":",this.state.min)}}]),t}(r.a.Component),ye={width:"100vw",height:"calc(99vh - 40px)  ",display:"flex",flexDirection:"column",justifyContent:"space-between"},Ee=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{style:ye},r.a.createElement(D.a,null,r.a.createElement(M.a,{xs:0,sm:4,md:6,lg:8}),r.a.createElement(M.a,{xs:24,sm:16,md:12,lg:8,align:"center"},r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(ve,null),r.a.createElement(J,null),r.a.createElement(H,null)),r.a.createElement(M.a,{xs:0,sm:4,md:6,lg:8})),r.a.createElement(D.a,null,r.a.createElement(M.a,{xs:0,sm:4,md:5}),r.a.createElement(M.a,{xs:24,sm:16,md:14,align:"center"},r.a.createElement(ge,null)),r.a.createElement(M.a,{xs:0,sm:4,md:5})))}}]),t}(r.a.Component),ke=a(330),Oe=ke.a.Title,je=ke.a.Paragraph,we=(ke.a.Text,function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(D.a,null,r.a.createElement(M.a,{xs:1,sm:2,md:3,lg:4}),r.a.createElement(M.a,{xs:22,sm:20,md:18,lg:16,align:"center"},r.a.createElement("div",{style:{backgroundColor:"#fff"}},r.a.createElement(ke.a,null,r.a.createElement(Oe,null,"\u7b80\u4ecb"),r.a.createElement(je,null,"\u8fd9\u4e2a\u7f51\u9875\u65e8\u5728\u63d0\u4f9b\u7b80\u6d01\u7684\u6d4f\u89c8\u5668\u4e3b\u9875, \u9664\u4e86\u4e3b\u9875,\u672a\u6765\u8fd8\u5c06\u63d0\u4f9b\u4e00\u7cfb\u5217\u7684\u6269\u5c55."),r.a.createElement(Oe,null,"\u8054\u7cfb\u6211"),r.a.createElement(je,null,"\u5982\u679c\u4f60\u6709\u610f\u89c1\u548c\u5efa\u8bae,\u6b22\u8fce\u53d1\u9001\u90ae\u4ef6\u81f3: ulan420@qq.com")))),r.a.createElement(M.a,{xs:1,sm:2,md:3,lg:4})))}}]),t}(r.a.Component)),Se=a(348),xe={width:"100vw",height:"35px",backgroundColor:"rgba(0,0,0,0)",position:"absolute",zIndex:"100"},Ce={color:"#fff",fontSize:"2rem"},_e=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).dealClick=function(){x.pub("header-menubtn-clicked")},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){x.newtopic("header-menubtn-clicked")}},{key:"render",value:function(){return r.a.createElement("div",{style:xe},r.a.createElement(Se.a,{style:Ce,onClick:this.dealClick}))}}]),t}(r.a.Component),Ie=a(326);var ze,Ae=new Array;function Ne(e,t){var a=new WebSocket("ws://localhost:8080");a.addEventListener("open",(function(t){e(a)})),a.onerror=function(){t()}}var Le={__state:"close",socket:null,routers:new Map,onCreate:null,onMsg:function(e){var t=JSON.parse(e);switch(t.head.origin){case"__wscli@all__":this.routers.forEach((function(t){t.onMsg&&t.onMsg(e)}));break;case"__wscli@file__":this.__sendFileSeg(t);break;default:var a=this.routers.get(t.head.origin);if(!a[t.head.callback])throw new Error("\u5bf9\u8c61\u4e0a\u6ca1\u6709\u5b9a\u4e49:"+t.head.callback+"\u8fd9\u4e2a\u51fd\u6570");a[t.head.callback](e)}},onErr:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"__wscli@all__",a={head:{origin:t,state:"error"},data:"\u9519\u8bef:"+e};this.onMsg(JSON.stringify(a))},init:function(e,t){this.routers.set(e,t),"close"==this.__state?this.conn():this.onCreate&&this.onCreate()},conn:function(){var e=Le;new Promise(Ne).then((function(t){e.onOpen(),e.socket=t,e.socket.addEventListener("message",(function(t){e.onMsg(t.data)})),e.socket.addEventListener("close",(function(t){e.onClose()})),e.onCreate&&e.onCreate()})).catch((function(t){e.reConn(),e.onErr("\u4e0e\u670d\u52a1\u5668\u5efa\u7acb\u94fe\u63a5\u5931\u8d25, \u5c06\u5c1d\u8bd5\u91cd\u65b0\u8fde\u63a5.")}))},send:function(e){"close"!=this.__state?("string"!=typeof e&&(e=JSON.stringify(e)),this.socket.send(e)):this.onErr("\u53d1\u9001\u5931\u8d25, \u4e0e\u670d\u52a1\u5668\u7684\u94fe\u63a5\u5df2\u65ad\u5f00.")},sendfile:function(e){var t=new FileReader;t.readAsDataURL(e),t.onload=function(e){console.log(this.result.length),function(e){Ae=[];for(var t=0,a=t+3072;a<e.length;t=a,a+=3072)Ae.push(e.slice(t,a));Ae.push(e.slice(t)),console.log("\u6587\u4ef6\u6bb5\u6570\uff1a",Ae.length),ze=Ae.length}(this.result),Le.__sendFileSeg=function(){var e,t=0;return function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n={head:{origin:"__wscli@file__",type:"__@fileUpload__",total:ze,handle:"handleAvatar"}};if(0==t&&(n.head.seq=0,e=(new Date).getTime(),Le.send(n),t++),a)if(a.head.ack<=a.head.total)t=a.head.ack,n.head.seq=t,n.data=Ae[t-1],Le.send(n);else{var r=(new Date).getTime();console.log("\u4f20\u8f93\u5b8c\u6210,\u5e73\u5747\u901f\u5ea6(KB/s)",2.304*a.head.total/(r-e)*1e3)}}}(),Le.__sendFileSeg()}},onOpen:function(){this.__state="conn"},onClose:function(){this.__conn="close";this.onMsg(JSON.stringify({head:{origin:"__wscli@all__",state:"error"},data:"\u9519\u8bef:\u4e0e\u670d\u52a1\u5668\u7684\u8fde\u63a5\u5df2\u4e2d\u65ad,\u5c06\u5c1d\u8bd5\u91cd\u65b0\u8fde\u63a5"})),this.reConn()},reConn:function(){"close"==this.__conn&&(this.routers.forEach((function(e){e.onClose&&e.onClose()})),setTimeout(this.conn,3e3))}},Pe=Le,Be=a(94),De=a(349),Me=a(350),Ue=a(351),Je=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={display:!1},a.data={},a.componentDidMount=function(){Pe.init("Sign",Object(Be.a)(a))},a.getData=function(e){a.data.id=a.refs.uid.state.value,a.data.name=a.refs.uname.state.value},a.getPwd=function(e){a.data.pwd=e.target.value},a.login=function(){a.getData();var e={head:{origin:"Sign",type:"login",callback:"login_res"},data:a.data};Pe.send(e)},a.login_res=function(e){if("error"==(e=JSON.parse(e)).head.state)K.a.error(e.data);else{K.a.success("\u767b\u5f55\u6210\u529f\u5566\u9a9a\u5e74\uff01"),window.localStorage.setItem("user",JSON.stringify(e.data)),window.localStorage.setItem("token",e.token);var t=e.data;t.login=!0,a.props.setUser(t),a.props.close()}},a.sign=function(){a.getData();var e={head:{origin:"Sign",type:"create_account",callback:"sign_res"},data:a.data};Pe.send(e)},a.sign_res=function(e){"error"==(e=JSON.parse(e)).head.state?K.a.error(e.data):K.a.success(e.data)},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(G.a,{visible:!!this.props.visible,footer:null,closable:!1},r.a.createElement("p",null,"\u4f60\u8fd8\u6ca1\u6709\u767b\u5f55, \u8d76\u5feb\u767b\u9646\u6216\u6ce8\u518c\u4e00\u4e2a\u8d26\u53f7\u5427!"),r.a.createElement(Y.a.Group,null,r.a.createElement(Y.a,{ref:"uid",type:"number",placeholder:"\u8f93\u5165id",prefix:r.a.createElement(De.a,null)}),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(Y.a.Password,{onChange:function(t){return e.getPwd(t)},ref:"upwd",placeholder:"\u8f93\u5165\u5bc6\u7801",prefix:r.a.createElement(Me.a,null)}),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(Y.a,{ref:"uname",placeholder:"\u8f93\u5165\u6635\u79f0",prefix:r.a.createElement(Ue.a,null)}),r.a.createElement("br",null)),r.a.createElement(X.a,{type:"primary",onClick:this.login},"\u767b\u5f55"),r.a.createElement(X.a,{type:"primary",onClick:this.sign},"\u6ce8\u518c"),r.a.createElement(X.a,{onClick:this.props.close},"\u5173\u95ed"))}}]),t}(r.a.Component);var Fe=Object(f.b)((function(e){return{}}),(function(){return{setUser:function(e){return S.dispatch({type:"userLogin",payload:e})}}}))(Je),Te=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e,t;return(e=localStorage.getItem("user"))?(t="http://localhost:3500/"+(e=JSON.parse(e)).id+"/avatar.png",r.a.createElement("div",null,r.a.createElement(V.a,{src:t,size:60})," ",e.name)):r.a.createElement("div",null,r.a.createElement(V.a,{size:60}))}}]),t}(r.a.Component),We={padding:"10px",textAlign:"center"},Re=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={userLogin:!1,showSign:!1,user:null},a.toLogin=function(){a.setState({showSign:!0})},a.closeLogin=function(){a.setState({showSign:!1})},a.upAvatar=function(){var e=a.refs.fileselect.files[0];console.log(e.size),Pe.sendfile(e)},a.logOut=function(){a.setState({userLogin:!1}),K.a.info("\u4f60\u5df2\u9000\u51fa\u767b\u5f55\uff01"),a.props.logOut()},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"componentWillMount",value:function(){var e;(e=localStorage.getItem("user"))?(e=JSON.parse(e),this.setState({userLogin:!0,user:e})):this.setState({userLogin:!1}),Pe.init("usrpre",this)}},{key:"render",value:function(){var e;return this.state.user&&(e=this.state.user.id),this.state.userLogin?r.a.createElement("div",{style:We},r.a.createElement(V.a,{size:50,src:"http://localhost:3500/"+e+"/avatar.png"}),r.a.createElement("br",null),this.props.user.name,r.a.createElement("br",null),r.a.createElement(X.a,{onClick:this.props.logOut},"\u9000\u51fa\u767b\u5f55"),r.a.createElement("br",null),r.a.createElement(Ie.a,null),"\u8bbe\u7f6e\u5934\u50cf",r.a.createElement("br",null),r.a.createElement("input",{type:"file",ref:"fileselect"}),r.a.createElement(X.a,{onClick:this.upAvatar},"\u786e\u5b9a")):r.a.createElement("div",{style:We},r.a.createElement(Fe,{visible:this.state.showSign,close:this.closeLogin}),r.a.createElement(Te,null),r.a.createElement("br",null),r.a.createElement(X.a,{type:"primary",onClick:this.toLogin},"\u53bb\u767b\u5f55"))}}]),t}(r.a.Component),qe=a(135),He=a(328),Ke=a(332),Ge=a(331),Ye=a(335),Xe=a(327),Ve={width:"100px",borderWidth:2,borderColor:"#1890ff",borderStyle:"solid",float:"left"},$e={float:"left",borderWidth:1,borderColor:"#eee",borderStyle:"solid",width:"100px"},Qe=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).changePic=function(){a.props.changeTo(a.props.Index)},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.currentIndex,a=e.Index,n=e.name,i=e.url;return r.a.createElement("div",{style:t==a?Ve:$e,onClick:this.changePic},r.a.createElement("img",{src:i,width:"100%"}),r.a.createElement("br",null),n)}}]),t}(r.a.Component),Ze={width:"90%",broader:"1px #ccc solid"},et=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={currentI:0},a.changeTo=function(e){a.setState({currentI:e}),a.props.changeIndex(e),x.pub("picindexchange",e),localStorage.setItem("bgPicsIndex",e)},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"componentWillUnmount",value:function(){this.setState({currentI:this.props.bgPic.index})}},{key:"render",value:function(){var e=this,t=this.props.bgPic.picUrls.map((function(t,a){return r.a.createElement(Qe,{currentIndex:e.props.bgPic.index,changeTo:e.changeTo,Index:a,key:a,name:t.name,url:t.url})}));return r.a.createElement("div",{style:Ze},t)}}]),t}(r.a.Component);var tt=Object(f.b)((function(e){return{bgPic:e.bgPic}}),(function(){return{changeIndex:function(e){return S.dispatch({type:"bgIndexChange",payload:e})}}}))(et),at=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={value:1},a.blurSize=0,a.onChange=function(e){a.setState({value:e.target.value}),1==e.target.value?a.props.changeThemeName("light"):a.props.changeThemeName("dark")},a.onBlurChange=function(e){x.pub("change-blur-size",e),a.blurSize=e},a.onBlurNumChange=function(e){x.pub("change-blur-size",e),a.blurSize=e},a.userLoginOut=function(){localStorage.removeItem("user"),a.props.delUser()},a.onDockOpacityChange=function(e){a.props.changeDockOpacity(e)},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"componentWillUnmount",value:function(){localStorage.setItem("blursize",this.blurSize)}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(D.a,null,r.a.createElement(M.a,{xs:0,sm:4,md:6,lg:8}),r.a.createElement(M.a,{xs:24,sm:16,md:18,lg:8},r.a.createElement(He.a,{title:"\u7528\u6237"},r.a.createElement(Re,{user:this.props.user,logOut:this.userLoginOut})),r.a.createElement("br",null),r.a.createElement(He.a,{title:"\u5916\u89c2"},"\u4e3b\u9898\u5207\u6362",r.a.createElement(Ke.a.Group,{onChange:this.onChange,value:this.state.value},r.a.createElement(Ke.a,{value:1},"Light"),r.a.createElement(Ke.a,{value:2},"Dark")),r.a.createElement(Ie.a,null),"dock\u80cc\u666f\u900f\u660e\u5ea6",r.a.createElement(Ge.a,{min:0,max:1,onChange:this.onDockOpacityChange,value:this.props.dockOpacity,step:.1}),r.a.createElement("br",null),"\u4fee\u6539\u80cc\u666f",r.a.createElement(tt,null),r.a.createElement(Ie.a,null),"\u80cc\u666f\u6a21\u7cca",r.a.createElement(Ge.a,{min:0,max:25,onChange:this.onBlurChange,value:"number"===typeof this.props.blurSize?this.props.blurSize:0}),r.a.createElement(Ye.a,{min:0,max:25,value:this.props.blurSize,onChange:this.onBlurNumChange})),r.a.createElement("br",null),r.a.createElement(He.a,{title:"\u6027\u80fd"},"\u51cf\u5c11\u52a8\u753b\u6548\u679c ",r.a.createElement(Xe.a,null))),r.a.createElement(M.a,{xs:0,sm:4,md:6,lg:8})))}}]),t}(r.a.Component);var nt=Object(f.b)((function(e){return{user:Object(qe.a)({},e.user),theme:Object(qe.a)({},e.theme),blurSize:e.bgBlurSize,dockOpacity:e.dockOpacity}}),(function(e){return{changeblursize:function(t){return e({type:"changeblursize",payload:t})},changeBackPic:function(t){return e({type:"changeblursize",payload:t})},changeThemeName:function(t){return e({type:"changethemename",payload:t})},changeDockOpacity:function(t){return e({type:"changeopacitysize",payload:t})},setUser:function(t){return e({type:"userLogin",payload:t})},delUser:function(){return e({type:"userLoginOut",payload:{}})}}}))(at),rt=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(_.a,{mode:"horizontal",defaultSelectedKeys:["1"]},r.a.createElement(_.a.Item,{key:"1"},r.a.createElement(p.b,{to:"/message/all"},"\u5899")),r.a.createElement(_.a.Item,{key:"2"},r.a.createElement(p.b,{to:"/message/send"},"\u79c1\u4fe1"))),r.a.createElement("div",{style:{height:"calc(100vh - 48px)"}},this.props.children))}}]),t}(r.a.Component),it=(Y.a.TextArea,{width:300,backgroundColor:"#fff",float:"left",padding:"5px"}),lt=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,i=new Array(n),l=0;l<n;l++)i[l]=arguments[l];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i))))._post_his=[],a.state={postit:[],connState:300,userUnlogin:!0,editvisible:!1,confirmLoading:!1},a.onMsg=function(e){"error"==(e=JSON.parse(e)).head.state&&K.a.error(e.data)},a.creatSuc=function(){a.setState({connState:200})},a.fetchDataBack=function(e){if("error"==(e=JSON.parse(e)).head.state)K.a.error(e.data);else{var t=!0,n=!1,r=void 0;try{for(var i,l=e.data[Symbol.iterator]();!(t=(i=l.next()).done);t=!0){var o=i.value;a._post_his.push(o)}}catch(s){n=!0,r=s}finally{try{t||null==l.return||l.return()}finally{if(n)throw r}}a.setState({postit:a._post_his})}},a.offset=0,a.fetchPostData=function(){var e=localStorage.getItem("token"),t=JSON.parse(localStorage.getItem("user")),n={head:{origin:"all-msg",type:"get_postit",callback:"fetchDataBack"},para:{limit:2,offset:a.offset,id:t.id,token:e}};Pe.send(n),a.offset+=2},a.postData=function(){var e=localStorage.getItem("token"),t=JSON.parse(localStorage.getItem("user")),n=a.refs.msginput.innerText,r=a.refs.msgtitle.state.value,i={head:{origin:"all-msg",type:"post_postit",callback:"postDataBack"},data:{sender:t.name,senderid:t.id,title:r,context:n,time:"2020:12:12:20:20"},para:{id:t.id,token:e}};a.setState({confirmLoading:!0}),r?Pe.send(JSON.stringify(i)):a.errInfo("\u60a8\u5fd8\u8bb0\u4e86\u586b\u5199\u6807\u9898,\u8fd9\u662f\u4e0d\u88ab\u5141\u8bb8\u7684\u884c\u4e3a.")},a.postDataBack=function(e){e=JSON.parse(e),a.setState({confirmLoading:!1}),"error"==e.head.state?K.a.error(e.data):(K.a.success(e.data),a.setState({editvisible:!1}))},a.errInfo=function(e){G.a.info({title:"\u8b66\u544a\uff1a",content:r.a.createElement("div",null,r.a.createElement("p",null,e))})},a.handleCancel=function(){a.setState({editvisible:!1,confirmLoading:!1})},a.openEdit=function(){a.setState({editvisible:!0})},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"componentWillMount",value:function(){window.localStorage.getItem("user")?this.setState({userUnlogin:!1}):this.setState({userUnlogin:!0})}},{key:"componentDidMount",value:function(){Pe.init("all-msg",this)}},{key:"render",value:function(){var e=this.state.postit.map((function(e,t){return r.a.createElement("div",{key:t,style:{display:"inline-block",margin:"5px"}},r.a.createElement("div",{style:it},r.a.createElement(V.a,{size:30,src:"http://localhost:3500/"+e.senderid+"/avatar.png"}),e.sender,r.a.createElement("h2",null,e.title),r.a.createElement("div",{style:{whiteSpace:"pre-line"}},e.context)))})),t=this.state,a=t.editvisible,n=t.confirmLoading;return r.a.createElement("div",null,r.a.createElement(Fe,{unLogin:this.state.userUnlogin}),r.a.createElement(G.a,{title:"\u968f\u624b\u5199",visible:a,onOk:this.postData,confirmLoading:n,onCancel:this.handleCancel},r.a.createElement(Y.a,{ref:"msgtitle",placeholder:"\u8f93\u5165\u6587\u7ae0\u6807\u9898"}),r.a.createElement("div",{ref:"msginput",contentEditable:"true",style:{minHeight:"3rem",backgroundColor:"#eee"}})),r.a.createElement("br",null),r.a.createElement(D.a,{gutter:[5,10]},r.a.createElement(M.a,{xs:24,sm:24,md:6,lg:5}),r.a.createElement(M.a,{xs:24,sm:24,md:14,lg:12},r.a.createElement("div",null,e),r.a.createElement(X.a,{onClick:this.fetchPostData},"\u66f4\u591a\u6d88\u606f"),r.a.createElement(X.a,{onClick:this.openEdit},"\u4e5f\u5199\u4e00\u4e2a")),r.a.createElement(M.a,{xs:0,sm:0,md:4,lg:8})))}}]),t}(r.a.Component),ot=a(352),st={maxWidth:"70%",padding:"10px",color:" white",wordBreak:"break-all",wordWrap:"break-word",backgroundColor:"cornflowerblue",border:"1px rgba(0,0,0,0) solid"},ct={borderRadius:"5px 0px 5px 5px"},ut={borderRadius:"0px 5px 5px 5px"},dt=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props.msgBody,t=null;return t="send"==e.type?$(st,ct):$(st,ut),r.a.createElement("div",{style:t},e.context)}}]),t}(r.a.Component),pt={width:"0px",height:"0px",border:"5px solid",borderColor:"transparent  cornflowerblue transparent transparent"},ht={width:"0px",height:" 0px",border:"5px solid",borderColor:" transparent  transparent transparent cornflowerblue"},mt=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{style:"left"==this.props.dir?pt:ht})}}]),t}(r.a.Component),ft={recv:{display:"flex",flexDirection:"row",justifyContent:"flex-start",margin:"5px 0px"},send:{display:"flex",flexDirection:"row",justifyContent:"flex-end",margin:"5px 0px"}},gt=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props.msgBody,t=[],a="http://localhost:3500/"+e.id+"/avatar.png";return"recv"==e.type&&(t.push(r.a.createElement(V.a,{src:a,size:30})),t.push(r.a.createElement(mt,{dir:"left"}))),t.push(r.a.createElement(dt,{msgBody:e})),"send"==e.type&&(t.push(r.a.createElement(mt,{dir:"right"})),t.push(r.a.createElement(V.a,{src:a,size:30}))),r.a.createElement("div",{style:"send"==this.props.msgBody.type?ft.send:ft.recv,key:this.props.index},t)}}]),t}(r.a.Component),bt=Y.a.TextArea,vt={msgCase:{width:"100%",height:"60vh",backgroundColor:"rgba(255,255,255,0.6)",overflowY:"scroll"},contaniner:{width:"100%",height:"100%",overflowY:"hidden",backgroundColor:"rgba(255,255,255,0.4)"}},yt=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).submit=function(){var e=a.refs.msginput.state.value,t=a.props.nowPeople.id;a.props.methods.send(t,e)},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=this.props.allMsg.filter((function(t){return t.id==e.props.nowPeople.id||"send"==t.type})).map((function(t,a){return"send"===t.type&&(t.id=e.props.nowUser.id),r.a.createElement(gt,{msgBody:t,key:a,index:a})})),a=r.a.createElement("div",{style:vt.contaniner},r.a.createElement("div",{style:{backgroundColor:"#fff",fontSize:"1.2rem"}},this.props.nowPeople.name),r.a.createElement("div",{style:vt.msgCase},t),r.a.createElement(D.a,null,r.a.createElement(M.a,{span:24},r.a.createElement(X.a,{onClick:this.submit},"\u53d1\u9001")),r.a.createElement(M.a,{span:24},r.a.createElement(bt,{ref:"msginput",rows:2,allowClear:!0})))),n=r.a.createElement("div",{style:{height:"80vh",backgroundColor:"#eee"}},"\u9009\u62e9\u4e00\u4e2a\u597d\u53cb\u6765\u804a\u5929");return r.a.createElement("div",null,this.props.nowPeople.name?a:n)}}]),t}(r.a.Component),Et={backgroundColor:"rgba(255,255,255,0.7)",padding:"2px 5px",borderWidth:1,borderColor:"#eee",borderStyle:"solid"},kt=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).handleClick=function(){a.props.methods.chatWith({id:a.props.friend.id,name:a.props.friend.name})},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props.friend,t="http://localhost:3500/"+e.id+"/avatar.png";return r.a.createElement("div",{style:Et,onClick:this.handleClick},r.a.createElement(V.a,{src:t,size:30})," ",e.name,r.a.createElement("p",null,"\u5feb\u6765\u548c\u6211\u804a\u5929\u5427"))}}]),t}(r.a.Component),Ot=(Y.a.TextArea,function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={connState:"\u4e16\u754c\u4e0a\u6700\u8fdc\u7684\u8ddd\u79bb\u5c31\u662f\u6ca1\u7f51...",user:null,token:"",allMsg:[],nowPeople:{name:"",id:NaN},friends:[],addfvis:!1},a.msgHistory=[],a.showFriends=function(){var e;(e=localStorage.getItem("friends"))?a.setState({friends:JSON.parse(e)}):(e=[{id:1e5,name:"ULAN"}],localStorage.setItem("friends",JSON.stringify(e)),a.setState({friends:e}))},a.addFriend=function(){var e={id:a.refs.infid.state.value,name:a.refs.infname.state.value};if(e.id&&e.name){var t=a.state.friends;t.push(e),localStorage.setItem("friends",JSON.stringify(t)),a.setState({friends:t})}else K.a.error("\u8bf7\u586b\u5199\u5b8c\u6210")},a.dealRecvMsg=function(e){if("success"==(e=JSON.parse(e)).head.state)switch(e.head.call){case"connres":K.a.success(e.data);break;case"newmsg":console.log(e.data),a.recv(e.data)}else K.a.error(e.data)},a.send=function(e,t){e=parseInt(e),a.msgHistory.push({type:"send",context:t}),a.setState({allMsg:a.msgHistory});var n={head:{origin:"SendMsg",type:"chat",callback:"dealRecvMsg",call:"newmsg"},para:{uid:a.state.user.id,tid:e,token:a.state.token,do:"send"},data:{senderid:a.state.user.id,sender:a.state.user.name,context:t,time:"2020:03:19"}};Pe.send(n)},a.chatWith=function(e){a.setState({nowPeople:e})},a.recv=function(e){var t=!0,n=!1,r=void 0;try{for(var i,l=e[Symbol.iterator]();!(t=(i=l.next()).done);t=!0){var o=i.value;a.msgHistory.push({type:"recv",id:o.senderid,context:o.context})}}catch(s){n=!0,r=s}finally{try{t||null==l.return||l.return()}finally{if(n)throw r}}a.setState({allMsg:a.msgHistory})},a.handleCancel=function(){a.setState({addfvis:!1})},a.handleAdd=function(){a.setState({addfvis:!0})},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){Pe.init("SendMsg",this);var e=JSON.parse(localStorage.getItem("user"));if(e){var t=localStorage.getItem("token");this.setState({user:e,token:t});var a={head:{origin:"SendMsg",type:"chat",callback:"dealRecvMsg",call:"connres"},para:{uid:e.id,token:t,do:"connect"}};Pe.send(a),this.showFriends()}}},{key:"componentWillUnmount",value:function(){var e=JSON.parse(localStorage.getItem("user"));if(e){var t=localStorage.getItem("token"),a={head:{origin:"SendMsg",type:"chat",callback:"dealRecvMsg",call:"connres"},para:{uid:e.id,token:t,do:"disconnect"}};Pe.send(a)}}},{key:"render",value:function(){var e=this,t=this.state.friends.map((function(t,a){return r.a.createElement(kt,{friend:t,methods:{chatWith:e.chatWith},key:a})}));return r.a.createElement(D.a,{gutter:[1]},r.a.createElement(G.a,{title:"\u7f16\u8f91",visible:this.state.addfvis,onOk:this.addFriend,onCancel:this.handleCancel},r.a.createElement(Y.a,{type:"number",ref:"infid",placeholder:"\u8f93\u5165id"}),r.a.createElement(Y.a,{ref:"infname",placeholder:"\u8f93\u5165\u5907\u6ce8"})),r.a.createElement(M.a,{span:6,style:{backgroundColor:"rgba(255,255,255,0.3)"}},r.a.createElement(X.a,{block:!0,onClick:this.handleAdd,icon:r.a.createElement(ot.a,null)},"\u6dfb\u52a0"),t),r.a.createElement(M.a,{span:18},r.a.createElement(yt,{allMsg:this.state.allMsg,nowPeople:this.state.nowPeople,nowUser:this.state.user,methods:{send:this.send}})))}}]),t}(r.a.Component)),jt=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={visible:!1},a.dealDrawer=function(){a.setState({visible:!0})},a.onClose=function(){a.setState({visible:!1})},a.userLoginOut=function(){localStorage.removeItem("user"),a.props.delUser()},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"componentWillMount",value:function(){var e;x.sub("header-menubtn-clicked",this.dealDrawer),(e=localStorage.getItem("user"))?(e=JSON.parse(e),this.props.setUser(e)):this.props.delUser(e)}},{key:"render",value:function(){var e;return e=this.props.user.login?r.a.createElement(Te,null):r.a.createElement(Re,{user:this.props.user,logOut:this.userLoginOut}),r.a.createElement(p.a,null,r.a.createElement(m.a,{title:"\u83dc\u5355",placement:"left",closable:!0,onClose:this.onClose,visible:this.state.visible},e,r.a.createElement(B,null)),r.a.createElement(_e,null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(h.d,null,r.a.createElement(h.b,{path:"/home",component:Ee}),r.a.createElement(h.b,{path:"/about",component:we}),r.a.createElement(h.b,{path:"/setting",component:nt}),r.a.createElement(h.b,{path:"/message",render:function(){return r.a.createElement(rt,null,r.a.createElement(h.b,{path:"/message/all",exact:!0,component:lt}),r.a.createElement(h.b,{path:"/message/send",exact:!0,component:Ot}),r.a.createElement(h.a,{to:"/message/all"}))}}),r.a.createElement(h.a,{to:"/home"})))}}]),t}(r.a.Component);var wt=Object(f.b)((function(e){return{user:e.user}}),(function(){return{setUser:function(e){return S.dispatch({type:"userLogin",payload:e})},delUser:function(){return S.dispatch({type:"userLoginOut",payload:{}})}}}))(jt),St=(a(322),{width:"100vw",height:"100vh",position:"fixed",zIndex:"-1",transition:"all 0.25s linear"}),xt=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={isBlur:!1,picUrls:a.props.bgPic.picUrls,index:a.props.bgPic.index},a.changeIndex=function(e){a.setState({index:e})},a.lastBlur=0,a.blur=function(){a.lastBlur=a.props.blurSize,0==a.state.isBlur&&a.props.changeblursize(25)},a.unblur=function(){1==a.state.isBlur&&a.blurBySize(a.lastBlur)},a.blurBySize=function(e){e>0?a.setState({isBlur:!0}):a.setState({isBlur:!1}),a.props.changeblursize(e)},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e;x.sub("picindexchange",this.changeIndex),(e=localStorage.getItem("blursize"))?(e=parseInt(e))>=0&&e<=25&&(this.lastBlur=e,this.setState({isBlur:!0}),this.props.changeblursize(e)):localStorage.setItem("blursize",0),x.sub("change-blur-size",this.blurBySize)}},{key:"render",value:function(){var e,t=this.state,a=t.picUrls,n=t.index,i={filter:"blur("+this.props.blurSize+"px)"},l={background:"url("+a[n=parseInt(n)].url+") no-repeat center ",backgroundSize:"cover"};return e=$(St,l,i),r.a.createElement("div",{style:e,className:this.state.isBlur?"blur":"unblur"})}}],[{key:"getDerivedStateFromProps",value:function(e,t){return{picUrls:e.bgPic.picUrls,index:e.bgPic.index}}}]),t}(r.a.Component);var Ct=Object(f.b)((function(e){return{theme:e.theme,blurSize:e.bgBlurSize,bgPic:e.bgPic}}),(function(e){return{changeblursize:function(t){return e({type:"changeblursize",payload:t})}}}))(xt);var _t=function(){return r.a.createElement("div",{className:"main"},r.a.createElement(Ct,null),r.a.createElement(wt,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));R.init(),l.a.render(r.a.createElement(f.a,{store:S},r.a.createElement(_t,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[184,1,2]]]);
//# sourceMappingURL=main.09019cf5.chunk.js.map